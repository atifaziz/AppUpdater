{"name":"AppUpdater","body":"AppUpdater\r\n===========\r\n\r\nThe objective of the AppUpdater component is to allow applications to be constantly and incrementally updated without user intervention.\r\nThe behavior is similar to Google Chrome's update. Each update downloads the minimum possible amount of data.\r\n\r\n\r\nHow it works\r\n------------\r\n1. The application checks from time to time the version defined in the update server;\r\n2. If the version is different from the one installed, then it starts the update procedure;\r\n3. A new folder is created for the new version, the unaltered files are copied to the new folder and the changed ones are downloaded;\r\n4. If the changed file has a delta available in the update server, only the delta is downloaded and not the entire file;\r\n5. The new version is set as the \"current version\";\r\n6. The next time the app is started it will use the new version.\r\n\r\n\r\nHow to use it\r\n-------------\r\nTo use the AppUpdater library the application must:\r\n\r\n1. follow a pre-defined structure (see later);\r\n2. have an update server with a pre-defined structure (see later);\r\n3. activate the code that checks for updates (see later).\r\n\r\n\r\nClient directory structure\r\n--------------------------\r\nThe application that uses the AppUpdater component must have a pre-defined structure.\r\nThe root of the application must contain the *Runner* and the *config.xml* file.\r\nThe application must be inside a folder with the same name as the current version.\r\n\r\nThe application is not directly executed. The *Runner* is executed and executes the corresponding application based on the current version.\r\nThe *config.xml* file has the definition of the current version and the url of the update server.\r\n\r\nClient structure:\r\n\r\n* Root\r\n    * AppUpdater.Runner.exe\r\n\t* config.xml\r\n\t* 1.0.0\r\n\t\t* MyApp.exe\r\n\t\t* MyLib.dll\r\n\r\n\r\nServer directory structure\r\n--------------------------\r\nThe update files must be available in a web server, following a pre-defined structure.\r\nYou don't need to create this structure manually, it's created by the publisher (see later).\r\nThe update server url must be defined in the *config.xml* file of the client app.\r\n\r\nThe *version.xml* file defines the current version. Based on this information, the corresponding directory is used.\r\nInside each directory there is a manifest file and the files that must be deployed. The manifest file defines the files to be downloaded.\r\n\r\nEach version can contain deltas that are used to update without downloading the entire file, just the parts that were changed.\r\n\r\nServer structure:\r\n\r\n* Root\r\n\t* version.xml\r\n\t* 1.0.0\r\n\t\t* manifest.xml\r\n\t\t* MyApp.exe.deploy\r\n\t\t* MyLib.dll.deploy\r\n\t* 2.0.0\r\n\t\t* manifest.xml\r\n\t\t* MyApp.exe.deploy\r\n\t\t* MyLib.dll.deploy\r\n\t\t* deltas\r\n\t\t\t* MyApp.exe.F872A.deploy\r\n\t\t\t* MyLib.dll.B89C0.deploy\r\n\r\n\r\nApplication Code\r\n----------------\r\nYou can use the following code to check for updates every hour. The update procedure will be executed automatically.\r\n\r\n```csharp\r\nAutoUpdater autoUpdater = new AutoUpdater(UpdateManager.Default);\r\nautoUpdater.SecondsBetweenChecks = 3600;\r\nautoUpdater.Start();\r\n```\r\nYou can also subscribe to the event `Updated` in order to be notified when an update has been made.\r\n\r\n\r\nUpdate process and deltas\r\n-------------------------\r\nThe update process will download only the new files and those which were changed.\r\nThe files that weren't changed between versions will just be copied from the old version.\r\n\r\nIf a file was modified, the update process will check if there is a delta available. \r\nIf there is one, it will use the delta instead of downloading the entire file.\r\n\r\nIn a normal update, only new files and the deltas will be downloaded. That means the update size will be very small.\r\n\r\n\r\nPublishing a version\r\n--------------------\r\nTo publish a version to the update server you must use the **AppUpdater.Publisher** utility. \r\nIt publishes the files to a defined directory; this directory must be served by a web server. \r\nRight now, the utility can't publish directly to a web server, just to a directory.\r\n\r\nThe usage of the publisher is as follow:\r\n\r\n    AppUpdate.Publisher.exe -source:source_dir -target:target_dir -deltas:2 -version:1.0.0\r\n\r\nThe **\"source\"** argument defines the directory containing the new version files. The **\"target\"** defines the directory of the update server. \r\nAnd **\"version\"** defines the number of the new version. \r\nThe **\"deltas\"** argument is optional; if defined, the publisher will generate deltas for older versions. The number of old versions is defined in this argument.\r\n\r\nIf, for example, you define the **\"deltas\"** argument as **\"10\"**, the publisher will generate deltas for the last 10 versions. \r\nIt means that if a client is 10 versions behind the current one, it can use the delta instead of downloading the entire file.\r\n\r\nIf the application is constantly executed, the user will probably have the latest version. \r\nIf it is used less frequently, it can have an older version, in that case it's a good idea to generate deltas for as many versions as you think would be needed.\r\n\r\n\r\nLimitations\r\n-----------\r\nRight now, the application can't be installed in the *\"Program Files\"* directory. \r\nApplications don't have permissions to write to the *\"Program Files\"* directory, which would keep the update process from being executed.\r\n\r\n\r\nCreating a setup\r\n----------------\r\nTo create a setup:\r\n\r\n1. do not install on the *Program Files* folder (see above);\r\n2. define the version as 0.0.0 (or something like that) in the *config.xml*;\r\n3. install the app in the folder corresponding to the version (in this example, it would be 0.0.0);\r\n4. define the update server url in the *config.xml*.\r\n\r\nThere is no problem in defining a version that doesn't exist. \r\nOn the first run, the application will check for updates, will see a different version number and execute the update procedure. \r\nIf the files in the latest version are equals to the files in the setup, they will just be copied to the new folder. No files will be downloaded.","tagline":"","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}